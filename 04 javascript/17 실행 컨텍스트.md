## [ìŠ¤ì½”í”„ (Scope)](https://github.com/tjdux/javascript/blob/main/13%20%EC%8A%A4%EC%BD%94%ED%94%84/01%20%EC%8A%A4%EC%BD%94%ED%94%84.md)
<br>

## ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸
- ì‹¤í–‰í•  ì½”ë“œì— ì œê³µí•  í™˜ê²½ ì •ë³´ë“¤ì„ ëª¨ì•„ ë†“ì€ ê°ì²´
- êµ¬ì„± ìš”ì†Œ
  - VariableEnvironment: ë³€ìˆ˜ ë° í•¨ìˆ˜ ì„ ì–¸ ì •ë³´ë¥¼ ì €ìž¥
  - LexicalEnvironment: ìŠ¤ì½”í”„ ì²´ì¸ ì •ë³´ë¥¼ ì €ìž¥, ë³€ìˆ˜ ê²€ìƒ‰ì— ì‚¬ìš©
  - ThisBinding: `this` í‚¤ì›Œë“œê°€ ì°¸ì¡°í•˜ëŠ” ê°ì²´ë¥¼ ê²°ì •
### Variable Environment (VE)
- ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•  ë–„, VEì— ì •ë³´ë¥¼ ë¨¼ì € ë‹´ì€ ë’¤ ì´ë¥¼ ë³µì‚¬í•˜ì—¬ LEë¥¼ ë§Œë“¤ê³  ì´í›„ì—ëŠ” LEë¥¼ ì£¼ë¡œ í™œìš©
- ìŠ¤ëƒ…ìƒ·ì„ ìœ ì§€ (ë³€ê²½ ë°˜ì˜ âŒ)
- environmentRecordì™€ outerEnvironmentReferenceë¡œ êµ¬ì„± (LEë„ ë™ì¼)
  - environmentRecord (record)
    - í˜„ìž¬ ì»¨í…ìŠ¤íŠ¸ì™€ ê´€ë ¨ëœ ì½”ë“œì™€ ì‹ë³„ìž ì •ë³´ë“¤ì´ ë³´ê´€
    - í•¨ìˆ˜ì— ì§€ì •ëœ ë§¤ê°œë³€ìˆ˜ ì‹ë³„ìž, í•¨ìˆ˜ ìžì²´, varë¡œ ì„ ì–¸ëœ ë³€ìˆ˜ ì‹ë³„ìž ë“±
  - outerEnvironmentReference (outer)
### Lexical Environment (LE)
- ì‹¤í–‰ ì¤‘ì¸ ì½”ë“œ ë¸”ë¡ì˜ ì‹ë³„ìžì™€ ë³€ìˆ˜ ì •ë³´ë¥¼ ë‹´ê³  ìžˆëŠ” í™˜ê²½ ê°ì²´
- âš ï¸ **ì½”ë“œë¥¼ ì„ ì–¸í•œ ìœ„ì¹˜ ê¸°ì¤€ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ìŠ¤ì½”í”„ ì²´ê³„**
  - ê°ì²´ ë¦¬í„°ëŸ´ì€ ë ‰ì‹œì»¬ í™˜ê²½ì„ ìƒì„±í•˜ì§€ ì•ŠìŒ
- ìŠ¤ëƒ…ìƒ·ì„ ìœ ì§€ í•˜ì§€ ì•Šê³  **ì‹¤ì‹œê°„ìœ¼ë¡œ ë³€ê²½ì‚¬í•­ì„ ê³„ì†í•´ì„œ ë°˜ì˜**
- êµ¬ì„± ìš”ì†Œ: EnvironmentRecord, outerEnvironment
  - EnvironmentRecord
    - ë³€ìˆ˜, í•¨ìˆ˜, ë§¤ê°œë³€ìˆ˜ ë“± ì‹¤ì œ ì‹ë³„ìžì™€ ê°’ì„ ì €ìž¥í•˜ëŠ” ê°ì²´
    - ì»¨í…ìŠ¤íŠ¸ ë‚´ë¶€ ì½”ë“œë¥¼ ìœ„ì—ì„œë¶€í„° ì•„ëž˜ë¡œ í•œ ì¤„ì”© ì½ìœ¼ë©° ê¸°ë¡ëœ ì •ë³´ ìˆ˜ì§‘
    - ðŸ’¡ **ì„ ì–¸ë§Œ ìˆ˜ì§‘í•˜ê³ , ì‹¤í–‰ì€ ë‚˜ì¤‘ì— ì‹œìž‘**
  - outer Environment: ì™¸ë¶€ ìŠ¤ì½”í”„ (ë¶€ëª¨ Lexical Environment)ë¥¼ ì°¸ì¡°í•˜ëŠ” í¬ì¸í„°
- **ìŠ¤ì½”í”„ ì²´ì¸, ë³€ìˆ˜ ì ‘ê·¼ , í´ë¡œì €, í˜¸ì´ìŠ¤íŒ… ëª¨ë‘ LE êµ¬ì¡°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìž‘ë™**
### ThisBinding
#### `this`
- **`this`ëŠ” ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ ë§Œë“¤ì–´ì§ˆ ë•Œ ê²°ì •ë˜ë©°, ê·¸ ê²°ì • ê¸°ì¤€ì€ í•¨ìˆ˜ í˜¸ì¶œ ë°©ì‹**
- **`this`ëŠ” ì„ ì–¸ ìœ„ì¹˜ (ìŠ¤ì½”í”„)ê°€ ì•„ë‹ˆë¼ í˜¸ì¶œ ë°©ì‹ì— ë”°ë¼ ê²°ì •ë¨**
- âš ï¸ í™”ì‚´í‘œ í•¨ìˆ˜ëŠ” ì˜ˆì™¸ì ìœ¼ë¡œ `this`ê°€ ìŠ¤ì½”í”„ì— ë”°ë¼ ê²°ì •ë¨

|í˜¸ì¶œ ë°©ì‹|`this` ê°’|
|---|---|
|ì „ì—­ í•¨ìˆ˜ í˜¸ì¶œ|`globalThis`|
|ê°ì²´ì˜ ë©”ì„œë“œ í˜¸ì¶œ|í•´ë‹¹ ê°ì²´|
|ìƒì„±ìž í•¨ìˆ˜ í˜¸ì¶œ|ìƒˆë¡œ ìƒì„±ëœ ì¸ìŠ¤í„´ìŠ¤|
|`call`/`apply`/`bind` í˜¸ì¶œ|ëª…ì‹œì ìœ¼ë¡œ ì§€ì •í•œ ê°ì²´|
|í™”ì‚´í‘œ í•¨ìˆ˜|**ì™¸ë¶€ ìŠ¤ì½”í”„ì˜ `this` (Lexical this)**|

#### `this` ë°”ì¸ë”© ê³¼ì •
- 1ï¸âƒ£ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•˜ë©´ì„œ ThisBindingì„ ì„¤ì •
- 2ï¸âƒ£ ì¼ë°˜ í•¨ìˆ˜ëŠ” í˜¸ì¶œ ì‹œì ì— ë”°ë¼ `this` ë³€í•¨
- 3ï¸âƒ£ í™”ì‚´í‘œ í•¨ìˆ˜ëŠ” ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ ìƒì„± ì‹œ, this ë°”ì¸ë”©ì„ ì•„ì˜ˆ í•˜ì§€ ì•ŠìŒ
  - ëŒ€ì‹  ì™¸ë¶€ ë ‰ì‹œì»¬ í™˜ê²½ì˜ `this`ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©
- ì¼ë°˜ í•¨ìˆ˜ì˜ `this`, í™”ì‚´í‘œ í•¨ìˆ˜ì˜ `this`
  - ì¼ë°˜ í•¨ìˆ˜: **í˜¸ì¶œ ë‹¹ì‹œ ê¸°ì¤€**ìœ¼ë¡œ ë™ì ìœ¼ë¡œ ë°”ì¸ë”©
  - í™”ì‚´í‘œ í•¨ìˆ˜: **ì„ ì–¸ ë‹¹ì‹œ ì™¸ë¶€ ë ‰ì‹œì»¬ í™˜ê²½ ê¸°ì¤€**ìœ¼ë¡œ ê³ ì •
```javascript
// 1ï¸âƒ£
let a = 1;
let outer = function(){
	console.log(this); //globalThis
	function inner(){
		console.log(this); //globalThis
	}
	inner()
}

outer();

// 2ï¸âƒ£ var: í•¨ìˆ˜ ë ˆë²¨ ìŠ¤ì½”í”„
var a = 1;
var outer = function() {
	var inner = function() {
		console.log(a); //undefined
		var a = 3;
	};
	inner();
	console.log(a); //1
};
outer();
console.log(a); //1

// 3ï¸âƒ£
const obj = {
  name: "SeoYeon",
  normalFunc: function () {
    console.log("normalFunc:", this.name);
  },
  arrowFunc: () => {
    console.log("arrowFunc:", this.name);
  },
};

obj.normalFunc(); // normalFunc: SeoYeon
obj.arrowFunc();  // arrowFunc: undefined
```
#### ëª…ì‹œì  `this` ë°”ì¸ë”©
- `call()`
```javascript
const obj = {
	a: 1,
	method: function (x, y) {
		console.log(this.a, x, y);
	}
};

obj.method(2, 3); // 1 2 3
obj.method.call({ a: 4 }, 5, 6); // 4 5 6
console.log(obj.a) //1
```
- `apply()`
```javascript
const func = function (a, b, c) {
	console.log(this, a, b, c);
};
func.apply({ x: 1 }, [4, 5, 6]); // { x: 1 } 4 5 6

const obj = {
	a: 1,
	method: function (x, y) {
		console.log(this.a, x, y);
	}
};

obj.method.apply({ a: 4 }, [5, 6]); // 4 5 6
console.log(obj.a) // 1
```
- ë©”ì„œë“œ í™œìš©
  - ìœ ì‚¬ë°°ì—´ê°ì²´ (array-like-object)ì— ë°°ì—´ ë©”ì„œë“œ ì ìš©
  ```javascript
  //ê°ì²´ì—ëŠ” ë°°ì—´ ë©”ì„œë“œë¥¼ ì§ì ‘ ì ìš© ë¶ˆê°€
  //ìœ ì‚¬ë°°ì—´ê°ì²´ì—ëŠ” call ë˜ëŠ” apply ë©”ì„œë“œë¥¼ ì´ìš©í•´ ë°°ì—´ ë©”ì„œë“œë¥¼ ì°¨ìš© ê°€ëŠ¥
  const obj = {
    0: 'a',
    1: 'b',
    2: 'c',
    length: 3
  };
  Array.prototype.push.call(obj, 'd');
  console.log(obj); // { 0: 'a', 1: 'b', 2: 'c', 3: 'd', length: 4 }

  const arr = Array.prototype.slice.call(obj);
  console.log(arr); // [ 'a', 'b', 'c', 'd' ]

  // ëŒ€ì•ˆ: Array.from()
  const arr1 = Array.from(obj);
  console.log(arr1) // [ 'a', 'b', 'c', 'd' ]
  ```
  - ìƒì„±ìž í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ë‹¤ë¥¸ ìƒì„±ìž í•¨ìˆ˜ í˜¸ì¶œ (ì½”ë“œ ìž¬ì‚¬ìš©)
  ```javascript
  function Person(name, gender) {
    this.name = name;
    this.gender = gender;
  }
  function Student(name, gender, school) {
    Person.call(this, name, gender); // ì—¬ê¸°ì„œ thisëŠ” student ì¸ìŠ¤í„´ìŠ¤
    this.school = school;
  }
  function Employee(name, gender, company) {
    Person.apply(this, [name, gender]); // ì—¬ê¸°ì„œ thisëŠ” employee ì¸ìŠ¤í„´ìŠ¤
    this.company = company;
  }
  const kd = new Student('ê¸¸ë™', 'male', 'ì„œìš¸ëŒ€');
  const ks = new Employee('ê¸¸ìˆœ', 'female', 'ì‚¼ì„±');
  ```
  - ì—¬ëŸ¬ ì¸ìˆ˜ë¥¼ í•˜ë‚˜ì˜ ë°°ì—´ë¡œ ì „ë‹¬í•  ë•Œ 
  ```javascript
  const numbers = [10, 20, 3, 16, 45];
  const max = Math.max.apply(null, numbers);
  const min = Math.min.apply(null, numbers);

  console.log(max, min); // 45 3
  ```
  - `bind()`ë¡œ `this` ê³ ì • ë° ë¶€ë¶„ ì ìš©
  ```javascript
  const func = function (a, b, c, d) {
	  console.log(this, a, b, c, d);
  };
  func(1, 2, 3, 4); // windowê°ì²´

  // í•¨ìˆ˜ì— this ë¯¸ë¦¬ ì ìš©
  const bindFunc1 = func.bind({ x: 1 }); 
  bindFunc1(5, 6, 7, 8); // { x: 1 } 5 6 7 8

  // ë¶€ë¶„ ì ìš© í•¨ìˆ˜ êµ¬í˜„
  // ì¸ìžë¥¼ ë¯¸ë¦¬ ë„˜ê²¨ì„œ ë‚˜ì¤‘ì— ì¼ë¶€ë§Œ ì±„ìš°ëŠ” ë¶€ë¶„ ì ìš© í•¨ìˆ˜ë„ ë§Œë“¤ ìˆ˜ ìžˆìŒ
  const bindFunc2 = func.bind({ x: 1 }, 4, 5); // 4ì™€ 5ë¥¼ ë¯¸ë¦¬ ì ìš©
  bindFunc2(6, 7); // { x: 1 } 4 5 6 7
  bindFunc2(8, 9); // { x: 1 } 4 5 8 9
  ```
#### this ìš°íšŒ íŒ¨í„´
- ì¼ë°˜ í•¨ìˆ˜ í˜¸ì¶œ ì‹œ ë°”ì¸ë”©ì´ ë‹¬ë¼ì ¸ `this` ì˜ˆì¸¡ì´ ì–´ë ¤ì›€
- ìš°íšŒ íŒ¨í„´ìœ¼ë¡œ ì›ëž˜ ì˜ë„í•œ ê°ì²´ë¥¼ ì°¸ì¡° 
- self = this
  - `self`ë¼ëŠ” ì§€ì—­ ë³€ìˆ˜ì— ê¸°ì¡´ `this`ë¥¼ ë‹´ì•„ ë‚´ë¶€ í•¨ìˆ˜ì—ì„œë„ ë™ì¼í•œ ê°ì²´ë¥¼ ì°¸ì¡°
  ```javascript
  const obj = {
  outer: function() {
    const self = this;
    function inner() {
      console.log(self); // â†’ {outer: Æ’}
    }
    inner();
    }
  };
  obj.outer();
  ```
- í™”ì‚´í‘œ í•¨ìˆ˜ í™œìš©
  - í™”ì‚´í‘œ í•¨ìˆ˜ëŠ” ìžì‹ ì´ ì„ ì–¸ëœ ìŠ¤ì½”í”„ì˜ `this`ë¥¼ ê·¸ëž˜ë„ ì‚¬ìš© 
  - ë‚´ë¶€ í•¨ìˆ˜ì—ì„œ `this`ê°€ ë‹¬ë¼ì§€ëŠ” ë¬¸ì œë¥¼ í•´ê²°
  ```javascript
  const obj = {
    outer: function() {
      const inner = () => {
        console.log(this); // â†’ {outer: Æ’}
      };
        inner();
      }
  };
  obj.outer();
  ```